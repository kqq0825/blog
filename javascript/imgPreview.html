<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端图片本地预览 | KQQ Blog</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="今天不学习，明天就下岗！">
    <link rel="preload" href="/blog/assets/css/0.styles.5608eb1c.css" as="style"><link rel="preload" href="/blog/assets/js/app.459e5512.js" as="script"><link rel="preload" href="/blog/assets/js/2.0e1075d0.js" as="script"><link rel="preload" href="/blog/assets/js/6.8fcbf67c.js" as="script"><link rel="prefetch" href="/blog/assets/js/3.823b1e2d.js"><link rel="prefetch" href="/blog/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/blog/assets/js/5.437192d4.js"><link rel="prefetch" href="/blog/assets/js/7.8fa74af5.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5608eb1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">KQQ Blog</span></a> <div class="links"><!----> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/javascript/imgPreview.html" aria-current="page" class="active sidebar-link">前端图片本地预览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/javascript/imgPreview.html#前端图片本地预览" class="sidebar-link">前端图片本地预览</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VUE</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前端图片本地预览"><a href="#前端图片本地预览" class="header-anchor">#</a> 前端图片本地预览</h2> <h3 id="blob对象"><a href="#blob对象" class="header-anchor">#</a> Blob对象</h3> <blockquote><p>Blob 对象表示一个不可变、原始数据的类文件对象。
在JavaScript中表示一个二进制数据，这个数据不一定是大数据，可以是个小文件，也可以是音频、视频、图像等大文件。</p></blockquote> <h4 id="属性"><a href="#属性" class="header-anchor">#</a> 属性：</h4> <p><code>Blob.size</code>: Blob 对象中所包含数据的大小（字节）。</p> <p><code>Blob.type</code>: 该 Blob 对象所包含数据的 MIME 类型（字符串）。</p> <h4 id="方法"><a href="#方法" class="header-anchor">#</a> 方法：</h4> <p><code>Blob.slice</code>: 截取数据源，返回一个新的Blob对象。</p> <p><code>Blob.stream()</code>: 返回一个能读取blob内容的 ReadableStream。</p> <p><code>Blob.text()</code>: 返回一个promise且包含blob所有内容的UTF-8格式的 USVString。</p> <p><code>Blob.arrayBuffer()</code>: 返回一个promise且包含blob所有内容的二进制格式的 ArrayBuffer 。</p> <h4 id="如何创建一个blob的对象"><a href="#如何创建一个blob的对象" class="header-anchor">#</a> 如何创建一个Blob的对象？</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span> array<span class="token punctuation">,</span> options <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// array </span>
array <span class="token operator">=</span> <span class="token punctuation">[</span>ArrayBuffer <span class="token operator">|</span> ArrayBufferView <span class="token operator">|</span> Blob <span class="token operator">|</span> DOMString<span class="token punctuation">]</span>
<span class="token comment">// options</span>
options<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">//MIME类型,默认值为&quot;&quot;</span>
  endings<span class="token operator">:</span> <span class="token string">&quot;transparent&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 表示结束符\n如何写入，但是该属性还未标准化。</span>
<span class="token punctuation">}</span>
</code></pre></div><p>举个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;abcdefg&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'text/plain'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myBlob<span class="token punctuation">)</span> <span class="token comment">// Blob {size: 7, type: &quot;text/plain&quot;}</span>
</code></pre></div><h3 id="file对象"><a href="#file对象" class="header-anchor">#</a> File对象</h3> <blockquote><p>特殊的Blob对象。比如<input>元素选择文件后返回的FileList对象集合的每个元素就是File对象。</p></blockquote> <ul><li>在继承了 Blob 对象的属性和方法的基础上，增加了一些文件相关的属性。比如lastModified name size</li> <li>Blob 对象使用的场合 File 对象都适用。</li></ul> <h3 id="blob-url"><a href="#blob-url" class="header-anchor">#</a> Blob URL</h3> <blockquote><p>一个指向存储在磁盘或者内存中blob的地址，来实现对这个blob的简单引用。
这个地址可以作为文件下载地址，也可以作为图片资源地址。</p></blockquote> <p>显示格式</p> <div class="language- extra-class"><pre class="language-text"><code>blob:http://XXX
</code></pre></div><h4 id="生成blob-url"><a href="#生成blob-url" class="header-anchor">#</a> 生成Blob URL</h4> <ul><li>URL.createObjectURL()  方法会创建一个特殊的Blob或者File对象的引用。</li> <li>同一个Blob 对象或者file对象每次通过 URL.createObjectURL() 会创建一个新的Blob URL。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建URL</span>
<span class="token keyword">var</span> objecUrl <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 释放URL</span>
 <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>objecUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="data-url"><a href="#data-url" class="header-anchor">#</a> Data URL</h3> <blockquote><p>前缀为data:协议的URL，主要作用就是在HTML文档中嵌入小文件。</p></blockquote> <p>显示格式</p> <div class="language-js extra-class"><pre class="language-js"><code>data<span class="token operator">:</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>mediatype<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">;</span>base64<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>data<span class="token operator">&gt;</span>
<span class="token comment">// 纯文本Hello, Word!</span>
data<span class="token operator">:</span><span class="token punctuation">,</span>Hello<span class="token operator">%</span><span class="token number">2</span>C<span class="token operator">%</span><span class="token number">20</span>World<span class="token operator">!</span>
<span class="token comment">// html </span>
data<span class="token operator">:</span>text<span class="token operator">/</span>html<span class="token punctuation">,</span><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token number">1111</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre></div><p>主要分为4个部分：</p> <ol><li>协议头 data:</li> <li>mediatype :说明MIME类型+编码方式的字符串。默认值是 text/plain;charset=US-ASCII 。</li> <li>base64  编码设定选项（可选项）。非文本类型的数据可以通过base64编码之后再嵌入。通过base64编码后，对于一些二进制的文件，比如图片，会使数据内容变得更加简短。</li> <li>这个Data URL承载的内容数据。</li></ol> <h4 id="生成data-url"><a href="#生成data-url" class="header-anchor">#</a> 生成Data URL</h4> <p><b>方式一：<b></b></b></p> <blockquote><p>通过FileReader对象的readAsDataURL()方法，来读取Blob或者File对象的数据，并转化为Date URL字符串来表示读取的内容。</p></blockquote> <ul><li><code>FileReader对象</code>：允许web应用程序异步读取存储在计算机上的文件的内容。需要通过 File对象 或者 Blob对象 指定要读取的文件或者数据。</li> <li><code>FileReader.result（属性）</code>：读取完成后获得的文件内容。</li> <li><code>FileReader.readAsDataURL （方法）</code>：开始读取指定Blob中的内容。返回的result会是一个data: URL格式的Base64字符串。</li> <li><code>FileReader.onload（事件）</code>：读取操作完成时触发事件。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//通过构造函数FileReader，创建一个reader实例对象</span>
<span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 增加onload事件，监听文件读取完毕</span>
reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// result获取文件内容</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//开始读取文件</span>
<span class="token keyword">var</span> myBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>myBlob<span class="token punctuation">)</span>
</code></pre></div><p><b>方式二：<b></b></b></p> <blockquote><p>通过canvas的toDataUrl()生成。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
</code></pre></div><h3 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h3> <table><thead><tr><th style="text-align:center;">Blob URL</th> <th style="text-align:right;">Data URL</th></tr></thead> <tbody><tr><td style="text-align:center;">长度较短</td> <td style="text-align:right;">长度较长</td></tr> <tr><td style="text-align:center;">直接对文件进行引用。</td> <td style="text-align:right;">会读取文件并对文件内容进行编码</td></tr> <tr><td style="text-align:center;">只能在当前应用内使用，页面刷新或者页面关闭无效。</td> <td style="text-align:right;">页面关闭依旧有效。</td></tr></tbody></table> <h3 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h3> <p><code>DOMString</code></p> <p>UTF-16字符串，Js目前的使用的String就是这种编码方式的字符串，所以可以直接理解为Js的字符串。</p> <p><code>MIME</code>
最初是使用在邮件传输中，规定传输内容的类型和编码方式。后来也在HTTP协议中被应用。
格</p> <blockquote><p>式： 主要类型/次要类型，默认值 text/plain，表示纯文本。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 形式
Content-Type: text/plain;  
// 常用类型
text/plain：纯文本，文件扩展名.txt
text/html：HTML文本，文件扩展名.htm和.html
image/jpeg：jpeg格式的图片，文件扩展名.jpg
image/gif：GIF格式的图片，文件扩展名.gif
audio/x-wave：WAVE格式的音频，文件扩展名.wav
audio/mpeg：MP3格式的音频，文件扩展名.mp3
video/mpeg：MPEG格式的视频，文件扩展名.mpg
application/zip：PK-ZIP格式的压缩文件，文件扩展名.zip
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/vue/key.html">
        vue中key的作用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.459e5512.js" defer></script><script src="/blog/assets/js/2.0e1075d0.js" defer></script><script src="/blog/assets/js/6.8fcbf67c.js" defer></script>
  </body>
</html>
